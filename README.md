# Лабораторная работа: Поставка мяса в кафе  
**Дисциплина:** СППР
**Платформа:** Camunda Platform 8 (Zeebe)  
**Версия Modeler:** 5.41.0  
**Дата:** Ноябрь 2025  

## Цель работы
Формализовать реальный бизнес-сценарий закупки скоропортящейся продукции (свинины) для кафе в виде исполняемой BPMN-диаграммы с использованием только разрешённых элементов:
- Действия (Task, User Task, Service Task, Business Rule Task, Script Task)
- События начала и конца
- XOR и AND шлюзы
- Таймеры
- Сообщения (Message Flow)

Запустить процесс в Camunda 8 и продемонстрировать его работу в Operate и Tasklist.

## Бизнес-сценарий: Поставка мяса в кафе

### Участники процесса
- **Шеф-повар** – определяет потребность в свинине
- **Управляющий кафе** – утверждает заявку, запрашивает КП
- **Закупщик** – выбирает поставщика, согласовывает заказ
- **Менеджер** (внешний участник) – получает запросы, готовит КП, выполняет заказ
- **Кладовщик** (внешний участник) – Комплектует заказ

### Основные этапы
1. Определение потребности → служебная записка  
2. Формирование заявки на закупку  
3. Запрос коммерческих предложений (RFQ)  
4. Получение и анализ КП (автоматизированный анализ через DMN)  
5. Выбор и сортировка поставщиков по общей стоимости  
6. Согласование и отправка заказа  
7. Обработка заказа поставщиком → комплектация → оформление документов  
8. Поставка и приёмка в кафе

## Особенности реализации

### Использованные элементы BPMN 2.0
| Элемент                    | Назначение                                   |
|----------------------------|-----------------------------------------------|
| User Task                  | Ручные действия сотрудников (формы в Tasklist) |
| Script Task                | Получение коммерческих предложений       |
| Business Rule Task         | Анализ КП через DMN-решение `DAnalyseKP`      |
| Script Task                | Сортировка по итоговой стоимости              |
| Exclusive Gateway (XOR)    | Ветвления: «Поставщик согласен?», «Есть подходящие КП?» |
| Parallel Gateway (AND)     | Параллельное оформление 3 документов у поставщика |
| Timer Intermediate Event   | Ожидание 24 часа при отсутствии подходящих КП |
| Message Start/End Events   | Взаимодействие кафе ↔ поставщик               |

### Автоматизация анализа коммерческих предложений
- Скрипт генерирует 5 разных поставщиков с ценами, сроками доставки, категорией свежести, наличием сертификатов и условиями оплаты
- DMN-решение фильтрует поставщиков по критериям:
  - Только свежая свинина (`svezhee`)
  - Наличие ветеринарных сертификатов
  - Доставка не дольше 3 дней
- Результат: `filteredSuppliers` (может быть `null` → переход на ожидание 24 ч)

### Формы в Tasklist
Все User Task имеют привязанные формы (Zeebe Form):
- `Form_memo` – служебная записка от шеф-повара
- `Form_Purchase_request` – заявка на закупку с таблицей по частям туши
- `Form_table_of_suppliers` – выбор поставщика из отфильтрованных
- `Form_Request_to_supplier` – отправка финальной заявки

## Структура проекта
├── bpmn/
│   └── diagram_2.bpmn.bpmn          
├── dmn/
│   └── Analysis_KP.dmn                    
├── forms/
│   ├── form1_memo.json
│   ├── Form2_Purchase_request.json
│   ├── form_3Request_commercial_proposals.form
│   ├── form4_table_of_suppliers.json
│   └── form5_Request_to_supplier.json
├── data/
│   └── suppliers.json
├── screenshots/
│   ├── BPMN.png
│   ├── DMN.png
│   ├── TaskList.png
│   └── Operat.png
├── reports/
│   └── ОтчетЛР_1.docx
│
├── docker-compose.yml
└── README.md

## Скриншоты работы (пример)
![Общий вид процесса в Modeler](screenshots/BPMN.png)  
![DMN-диограмма](screenshots/DMN.png) 
![Tasklist – форма заявки на закупку](screenshots/TaskList.png)  
![Operate – история экземпляра](screenshots/Operat.png)

## Выводы
Процесс полностью соответствует реальной практике закупок скоропортящейся продукции в HoReCa.  
Автоматизация анализа КП с помощью DMN и скриптов значительно снижает ручной труд закупщика.  
Использование таймера 24 часа позволяет автоматически повторить запрос, если сразу нет подходящих предложений.

**Работа успешно выполнена и протестирована в Camunda Platform 8 (Zeebe).**

---
**Автор:** Варакин Данил Эдуардович  
**Группа:** 1378  
